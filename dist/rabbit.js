!function(){"use strict";function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function i(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var n=function(){function n(e){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),!(this instanceof n))return new n(e);this.__isAsync=e,this.__e={},this.splitter="."}var s,r;return s=n,(r=[{key:"getListeners",value:function(e){var i=e.split("."),n=i.length;return Object.values(this.__e).reduce((function(e,s){for(var r=s.path,a=r.length,o=Math.max(n,a),l=!0,u=0;u<o;u++){var p=i[u],h=r[u];if("*"===p&&n===u+1)break;if("*"===h&&a===u+1)break;if("*"!==p&&"*"!==h&&p!==h){l=!1;break}}return l&&e.push.apply(e,function(e){if(Array.isArray(e))return t(e)}(c=s.listeners)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(c)||function(e,i){if(e){if("string"==typeof e)return t(e,i);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?t(e,i):void 0}}(c)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),e;var c}),[])}},{key:"on",value:function(t,i,n){if("function"==typeof i)return n||(n=null),"object"!==e(this.__e[t])&&(this.__e[t]={path:t.split(this.splitter),listeners:[]}),this.__e[t].listeners.push({listener:i,context:n}),i}},{key:"removeListener",value:function(e,t){var i=this.getListeners(e);if(Array.isArray(i)){var n=i.findIndex((function(e){return t===e.listener}),this);n<0||(i.splice(n,1),i.length||delete this.__e[e])}}},{key:"emit",value:function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];var s=this.getListeners(e);Array.isArray(s)&&(this.__isAsync?s.slice(0).forEach((function(e){setImmediate((function(){e.listener.apply(e.context,i)}))})):s.slice(0).forEach((function(e){e.listener.apply(e.context,i)})))}},{key:"once",value:function(e,t,i){var n=this;return i||(i=null),this.on(e,(function s(){n.removeListener(e,s);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];t.apply(i,a)})),t}}])&&i(s.prototype,r),n}();window.ExtendEventEmitter=n;var s=n;function r(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function a(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?r(Object(i),!0).forEach((function(t){o(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):r(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function o(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var p=function(){function e(t,i){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),!(i instanceof g))throw"animationsManager должен быть объектом класса AnimationsManager";this.processed=[],this.targets=[],this.manager=i,this.addTargets(t),this.manager.addTargets(this)}var t,i;return t=e,(i=[{key:"addTargets",value:function(t){if("object"!==l(t))throw"targetObject должен быть объектом или массивом объектов";return t instanceof e&&(t=t.targets),Array.isArray(t)||(t=[t]),t.forEach((function(t){if("object"===l(t)){if(t instanceof e)return this.addTargets(t);this.targets.some((function(e){return t===e}),this)||this.targets.push(t)}}),this),this}},{key:"removeTargets",value:function(e){if("object"!==l(e))throw"targetObject должен быть объектом или массивом объектов";return this.targets=this.targets.filter((function(t){return t!==e}),this),this}},{key:"destroy",value:function(){this.isDestroy=!0,this.targets=[],this.processed=[],this.manager.removeTargets(this)}},{key:"play",value:function(e,t,i){var n;if(!0===i&&this.stop(),!this.processed.some((function(t){return!(e!==t.presetName||!t.isPlayed)||(e===t.presetName&&(n=t),!1)}),this)){if(n)t&&"object"===l(t)&&!Array.isArray(t)&&(n.options=t),n.isPlayed=!0,n.animations.forEach((function(e){e.isPlayed=!0}),this),this.manager.addProcessed(this);else if(e&&this.manager.presets[e]){if(t&&"object"===l(t)||(t={}),!this.manager.presets[e])return;n={presetName:e,isPlayed:!0,startedTime:this.manager.timer,playedTime:0,options:t,animations:this.manager.presets[e].filter((function(e){return!!e.time&&!!e.name})).map((function(e){return a(a({loop:1,delay:0},e),{},{isPlayed:!0})}),this)},this.processed.push(n),this.manager.addProcessed(this)}else Object.keys(this.manager.presets).forEach((function(e){this.play(e,t)}),this);return this}}},{key:"pause",value:function(e){return this.processed.forEach((function(t){if(!e||t.presetName===e){if(!t.isPlayed)return;t.isPlayed=!1,t.pausedTime=this.manager.timer,t.animations.forEach((function(e){e.isPlayed=!1}),this)}}),this),this.processed.length||this.manager.removeProcessed(this),this}},{key:"resume",value:function(e){var t;if(!this.processed.some((function(i){return!(e!==i.presetName||!i.isPlayed)||(e===i.presetName&&(t=i),!1)}),this))return!!t&&(t.isPlayed=!0,t.animations.forEach((function(e){e.isPlayed=!0}),this),this.manager.addProcessed(this)),this}},{key:"stop",value:function(e){return this.processed=this.processed.filter((function(t){return!(!e||t.presetName===e)}),this),this.processed.length||this.manager.removeProcessed(this),this}},{key:"update",value:function(){if(!this.isDestroy)return this.processed.forEach((function(e){var t=this;if(e.isPlayed){var i=e.animations.map((function(i){if(!i.isPlayed)return!1;var n=t.manager.animators[i.name];if(!i.name||!i.isPlayed||!n)return!1;if(e.playedTime=t.manager.timer-e.startedTime,e.playedTime<i.delay)return!0;var s=(e.playedTime-i.delay)/i.time,r=s-Math.floor(s);return i.yoyo&&(r=1-2*Math.abs(r-.5)),i.loop&&s>=i.loop&&(r=i.yoyo?0:1,i.isPlayed=!1),i.reverse&&(r=1-r),t.targets.forEach((function(t,s){var a=n.next(r,t,i,e.options);"string"==typeof i.value&&void 0!==a&&("add"==i.mode?t[i.value]+=a:t[i.value]=a)}),t),i.loop&&s>=i.loop&&(i.isPlayed=!1),i.isPlayed}),this);e.isPlayed=i.some((function(e){return e}))}}),this),this;this.manager.removeTargets(this)}}])&&u(t.prototype,i),e}(),h=p;function c(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}window.AnimationsWrapper=p;var m=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.isDisable=!1,this.setAnimator(t)}var t,i;return t=e,(i=[{key:"setAnimator",value:function(e){return Array.isArray(e)?this.animator=function(t,i,n){if(n.intetpolate){var s=e.length-1,r=t*s,a=r-Math.floor(r/s)*s,o=Math.floor(a),l=o+1;return l>=e.length&&(l=e.length-1),e[o]+(e[o]-e[l])*(o-a)}return e[Math.floor(t*(e.length+1))]}:this.animator="function"==typeof e?e:function(e){return e},this}},{key:"next",value:function(e,t,i,n){if(!this.isDisable)return this.animator(e,t,i,n)}},{key:"disable",value:function(){this.isDisable=!0}},{key:"enable",value:function(){this.isDisable=!1}}])&&c(t.prototype,i),e}(),f=m;function y(e){return(y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function d(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}window.AnimationsProcessor=m;var b=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.scene=t,this.animators={},this.presets={},this.processed=[],this.targets=[],this.timer=0}var t,i;return t=e,(i=[{key:"addAnimator",value:function(e,t){if("string"!=typeof e)throw"processorName должен быть строкой";if(!(Array.isArray(t)||"function"==typeof t||t instanceof f))throw"animator должен быть функцией одного аргумента, массивом или объектом класса AnimationsProcessor";return this.animators[e]=t instanceof f?t:new f(t),this}},{key:"removeAnimator",value:function(e){if("string"!=typeof e)throw"processorName должен быть строкой";return delete this.animators[e],this}},{key:"addPreset",value:function(e,t){return Array.isArray(t)||(t=[t]),this.presets[e]=t,this}},{key:"removePreset",value:function(e){if("string"!=typeof e)throw"presetName должен быть строкой";return delete this.presets[e],this}},{key:"addTargets",value:function(e){if("object"!==y(e))throw"targetObject должен быть объектом или массивом объектов";if(e instanceof h){if(this.targets.indexOf(e)>=0)return;this.targets.push(e)}else Array.isArray(e)||(e=[e]),new h(e,this);return this}},{key:"removeTargets",value:function(e){if("object"!==y(e))throw"targetObject должен быть объектом или массивом объектов";if(Array.isArray(e))return e.forEach((function(e){this.removeTargets(e)}),this);if(e instanceof h){var t=this.targets.indexOf(e);if(t<0)return;this.targets.splice(t,1),this.removeProcessed(e)}else this.targets.slice(0).forEach((function(t){t.removeTargets(e),t.targets.length&&t.destroy()}),this);return this}},{key:"destroy",value:function(e){return this.isDestroy=!0,this.targets.forEach((function(e){e.destroy()}),this),this.animators={},this.presets={},this.processed=[],this.targets=[],this}},{key:"addProcessed",value:function(e){if("object"!==y(e))throw"targetObject должен быть объектом или массивом объектов";return Array.isArray(e)||(e=[e]),e.forEach((function(e){e instanceof h&&(this.processed.indexOf(e)>=0||this.processed.push(e))}),this),this}},{key:"removeProcessed",value:function(e){if("object"!==y(e))throw"targetObject должен быть объектом или массивом объектов";if(Array.isArray(e))return e.forEach((function(e){this.removeProcessed(e)}));if(e instanceof h){var t=this.processed.indexOf(e);if(!(t<0))return this.processed.splice(t,1),this}}},{key:"update",value:function(e){if(!this.isDestroy)return this.timer+=e,this.processed.forEach((function(e){e instanceof h&&e.update()})),this}},{key:"play",value:function(e){return this.targets.forEach((function(t){t.play(e)}),this),this}},{key:"stop",value:function(e){return this.targets.forEach((function(t){t.stop(e)}),this),this}},{key:"pause",value:function(e){return this.targets.forEach((function(t){t.pause(e)}),this),this}},{key:"resume",value:function(e){return this.targets.forEach((function(t){t.resume(e)}),this),this}}])&&d(t.prototype,i),e}(),g=b;function v(e,t,i){var n=e<t?1:-1,s=i+(1-i)*(1-Math.min(Math.abs(e-t),Math.abs(e-t+n))/.5);return Math.floor(255*s)}function _(e){return(_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function x(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}window.AnimationsManager=b;var k=function(){function e(t,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.component=t,this.factory=t.factory,this.game=this.factory.game,this.app=this.factory.app,this.manager=t.manager,this.group=t.group,this.config=i,this.scale={x:i.scale?"number"==typeof i.scale?i.scale:i.scale.x?i.scale.x:1:1,y:i.scale?"number"==typeof i.scale?i.scale:i.scale.y?i.scale.y:1:1},this.position={x:i.position?"number"==typeof i.position?i.position:i.position.x?i.position.x:0:0,y:i.position?"number"==typeof i.position?0:i.position.y?i.position.y:0:0},this.origin={x:"number"==typeof i.origin?i.origin:"object"===_(i.origin)&&"number"==typeof i.origin.x?i.origin.x:.5,y:"number"==typeof i.origin?i.origin:"object"===_(i.origin)&&"number"==typeof i.origin.y?i.origin.y:.5},this.animations=i.animations,this.layerName=i.layerName,this.componentName=this.component.componentName,this.setTexture(i.spriteName,i.frameName),this.setOrigin(this.origin.x,this.origin.y).setPosition(0,0).setScale(1,1).setAngle(i.angle).setAlpha(i.alpha).setBlendMode(i.blend).hide(),this.wrapper=new h(this,this.manager)}var t,i;return t=e,(i=[{key:"destroy",value:function(){this.wrapper.destroy();var e=this.component.layers.indexOf(this);return e>=0&&this.component.layers.splice(e,1),this.group.remove(this.sprite),this.sprite.destroy(),this}},{key:"play",value:function(e,t,i){var n=this.animations[e];return!0===i&&(this.stop(),this.hide()),n?(this.wrapper.play(n,t,i),this.show()):(this.stop(e),this.hide()),this}},{key:"stop",value:function(e){var t=this.animations[e];return this.wrapper.stop(t),this}},{key:"hide",value:function(){return this.sprite.visible=!1,this}},{key:"show",value:function(){return this.sprite.visible=!0,this}},{key:"setAlpha",value:function(e){return this.sprite.alpha="number"==typeof e?e:this.sprite.alpha||0,this}},{key:"setTint",value:function(e){return this.sprite.tint="number"==typeof e?e:this.sprite.tint||16777215,this}},{key:"setHue",value:function(e,t){var i="number"==typeof t?t:1,n="number"==typeof e?e:1,s=Math.floor(i*v(n,.166,.25)),r=Math.floor(i*v(n,.5,.25)),a=Math.floor(i*v(n,.833,.25));return this.sprite.tint=(s<<16)+(r<<8)+a,this}},{key:"setIllumination",value:function(e){var t=Number.parseInt(255*("number"==typeof e?e:1));return this.sprite.tint=(t<<16)+(t<<8)+t,this}},{key:"setAngle",value:function(e){return this.sprite.angle="number"==typeof e?e:this.sprite.angle||0,this}},{key:"setBlendMode",value:function(e){var t=PIXI.BLEND_MODES[e]||PIXI.BLEND_MODES.NORMAL;return this.sprite.blendMode=t,this}},{key:"setPosition",value:function(e,t){return this.sprite.x=this.position.x+("number"==typeof e?e:this.sprite.x||0),this.sprite.y=this.position.y+("number"==typeof t?t:this.sprite.y||0),this}},{key:"setScale",value:function(e,t){return this.sprite.scale.x=this.scale.x*("number"==typeof e?e:1),this.sprite.scale.y=this.scale.y*("number"==typeof t?t:e),this}},{key:"setOrigin",value:function(e,t){return this.sprite.anchor.x="number"==typeof e?e:.5,this.sprite.anchor.y="number"==typeof t?t:this.sprite.anchor.x,this}},{key:"setFrame",value:function(e){if("number"!=typeof e&&"string"!=typeof e)return this;if("string"!=typeof this.spriteName||!this.spriteName)return this;this.frameName=e;var t=this.getTexture(this.spriteName,this.frameName);return this.sprite.texture=t,this}},{key:"setTexture",value:function(e,t){if(!e)return this;if(this.spriteName===e)return this.setFrame(t),this;this.spriteName=e,this.frameName=t;var i=this.sprite;return this.sprite=this.getSprite(e,t),this.sprite.layerName=this.config.layerName,this.sprite.myLayer=this,this.group.addChild(this.sprite),i&&(this.sprite.x=i.x,this.sprite.y=i.y,this.sprite.alpha=i.alpha||1,this.sprite.angle=i.angle||0,this.sprite.anchor.x=i.anchor.x||.5,this.sprite.anchor.y=i.anchor.y||.5,this.sprite.tint=i.tint||16777215,this.sprite.scale.setTo(i.scale.x||1,i.scale.y||1),i.destroy()),this}},{key:"setTiles",value:function(e,t){return this}},{key:"setText",value:function(){return this}},{key:"getTillingSprite",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0,s=this.getTexture(e,t);return new PIXI.TilingSprite(s,i,n)}},{key:"getSprite",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=this.getTexture(e,t);return new PIXI.Sprite(i)}},{key:"getTexture",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(!e||"string"!=typeof e)throw"Sprite ".concat(e," must be nonzero string");var i=this.app.loader.resources[e];if(!i)throw"Sprite ".concat(e," must be loaded before used");if(i.textures){if(["string","number"].indexOf(_(t))<0)throw"Frame ".concat(t," of sprite ").concat(e," must be number or nonzero string");var n=Object.values(i.textures),s=i.textures[t]||n[t]||n[0];return s}if(i.texture)return i.texture;throw"ups!!!"}}])&&x(t.prototype,i),e}();function w(e){return(w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function N(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var T=function(){function e(t,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.component=t,this.factory=t.factory,this.game=this.factory.game,this.scene=t.scene,this.manager=t.manager,this.group=t.group,this.config=i,this.cacheFrameSizes={},this.frames=this.factory.frames,this.scale={x:i.scale?"number"==typeof i.scale?i.scale:i.scale.x?i.scale.x:1:1,y:i.scale?"number"==typeof i.scale?i.scale:i.scale.y?i.scale.y:1:1},this.position={x:i.position?"number"==typeof i.position?i.position:i.position.x?i.position.x:0:0,y:i.position?"number"==typeof i.position?0:i.position.y?i.position.y:0:0},this.tiles={x:i.tiles?"number"==typeof i.tiles?i.tiles:i.tiles.x?i.tiles.x:1:1,y:i.tiles?"number"==typeof i.tiles?i.tiles:i.tiles.y?i.tiles.y:1:1},this.origin={x:"number"==typeof i.origin?i.origin:"object"===w(i.origin)&&"number"==typeof i.origin.x?i.origin.x:.5,y:"number"==typeof i.origin?i.origin:"object"===w(i.origin)&&"number"==typeof i.origin.y?i.origin.y:.5},this.animations=i.animations,this.layerName=i.layerName,this.setTexture(i.spriteName,i.frameName),this.setOrigin(this.origin.x,this.origin.y).setScale(1,1).setAngle(i.angle).setAlpha(i.alpha).setTiles(this.tiles.x,this.tiles.y).setPosition(0,0).hide(),this.wrapper=new h(this,this.manager)}var t,i;return t=e,(i=[{key:"destroy",value:function(){this.wrapper.destroy();var e=this.component.layers.indexOf(this);return e>=0&&this.component.layers.splice(e,1),this.group.remove(this.sprite),this.sprite.destroy(),this}},{key:"play",value:function(e,t,i){var n=this.animations[e];return!0===i&&(this.stop(),this.hide()),n?(this.wrapper.play(n,t,i),this.show()):(this.stop(),this.hide()),this}},{key:"stop",value:function(e){var t=this.animations[e];return this.wrapper.stop(t),this}},{key:"getFrameSize",value:function(e,t){var i,n=e+"/"+t;if(this.cacheFrameSizes[n])return this.cacheFrameSizes[n];if(!(i="string"==typeof t?this.scene.cache.getFrameByName(e,t):"number"==typeof t?this.scene.cache.getFrameByIndex(e,t):this.scene.cache.getImage(e)))throw'не удалось получить размер для спрайта/кадра "'+n+'"';var s={width:i.width,height:i.height};return this.cacheFrameSizes[n]=s,s}},{key:"hide",value:function(){return this.sprite.visible=!1,this}},{key:"show",value:function(){return this.sprite.visible=!0,this}},{key:"setAlpha",value:function(e){return this.sprite.alpha="number"==typeof e?e:this.sprite.alpha||0,this}},{key:"setTint",value:function(e){return this.sprite.tint="number"==typeof e?e:this.sprite.tint||16777215,this}},{key:"setHue",value:function(e,t){var i="number"==typeof t?t:1,n="number"==typeof e?e:1,s=Math.floor(i*v(n,.166,.25)),r=Math.floor(i*v(n,.5,.25)),a=Math.floor(i*v(n,.833,.25));return this.sprite.tint=(s<<16)+(r<<8)+a,this}},{key:"setIllumination",value:function(e){var t=Number.parseInt(255*("number"==typeof e?e:1));return this.sprite.tint=(t<<16)+(t<<8)+t,this}},{key:"setAngle",value:function(e){return this.sprite.angle="number"==typeof e?e:this.sprite.angle||0,this}},{key:"setPosition",value:function(e,t){return this.sprite.x=this.position.x+("number"==typeof e?e:this.sprite.x||0),this.sprite.y=this.position.y+("number"==typeof t?t:this.sprite.y||0),this}},{key:"setScale",value:function(e,t){return e="number"==typeof e?e:1,t="number"==typeof t?t:e,this.sprite.scale.setTo(this.component.scale.x*this.scale.x*e,this.component.scale.y*this.scale.y*t),this}},{key:"setOrigin",value:function(e,t){return this.sprite.anchor.x="number"==typeof e?e:.5,this.sprite.anchor.y="number"==typeof t?t:this.sprite.anchor.x,this}},{key:"setFrame",value:function(e){if("number"!=typeof e&&"string"!=typeof e)return this;if(this.frameName=e,"number"==typeof e)this.sprite.frame=e;else{if("string"!=typeof e)throw"вы пытаетесь установить "+e+" у "+this.spriteName;var t=this.factory.frames[this.spriteName];if(!t)return this.factory.findFramesData(this.spriteName),this;var i=t[e];if("number"!=typeof i)return this;this.sprite.frame=i}return this}},{key:"setTiles",value:function(e,t){this.tiles.x="number"==typeof e?e:.5,this.tiles.y="number"==typeof t?t:e;var i=this.getFrameSize(this.spriteName,this.frameName);return this.sprite.width=i.width*this.tiles.x,this.sprite.height=i.height*this.tiles.y,this}},{key:"setTexture",value:function(e,t){if(!e)return this;if(this.spriteName===e)return this.setFrame(t),this;this.spriteName=e,this.frameName=t;var i=this.sprite,n=this.getFrameSize(e,t);return this.sprite=this.scene.add.tileSprite(0,0,n.width*this.tiles.x,n.height*this.tiles.y,e,t),this.group.add(this.sprite),this.sprite.layerName=this.config.layerName,this.sprite.myLayer=this,i&&(this.sprite.x=i.x,this.sprite.y=i.y,this.sprite.alpha=i.alpha||1,this.sprite.angle=i.angle||0,this.sprite.anchor.x=i.anchor.x||.5,this.sprite.anchor.y=i.anchor.y||.5,this.sprite.tint=i.tint||16777215,this.sprite.scale.setTo(i.scale.x||1,i.scale.y||1),i.destroy()),this}},{key:"setText",value:function(){return this}}])&&N(t.prototype,i),e}();function S(e){return(S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function O(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var A=function(){function e(t,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.component=t,this.factory=t.factory,this.game=this.factory.game,this.scene=t.scene,this.manager=t.manager,this.group=t.group,this.config=i,this.scale={x:i.scale?"number"==typeof i.scale?i.scale:i.scale.x?i.scale.x:1:1,y:i.scale?"number"==typeof i.scale?i.scale:i.scale.y?i.scale.y:1:1},this.position={x:i.position?"number"==typeof i.position?i.position:i.position.x?i.position.x:0:0,y:i.position?"number"==typeof i.position?0:i.position.y?i.position.y:0:0},this.origin={x:"number"==typeof i.origin?i.origin:"object"===S(i.origin)&&"number"==typeof i.origin.x?i.origin.x:.5,y:"number"==typeof i.origin?i.origin:"object"===S(i.origin)&&"number"==typeof i.origin.y?i.origin.y:.5},this.style="object"===S(i.style)?i.style:{},this.animations=i.animations,this.layerName=i.layerName,this.sprite=new PIXI.Text(i.text,this.style),"number"==typeof this.style.lineSpacing&&(this.sprite.lineSpacing=this.style.lineSpacing),this.setText(i.text).setOrigin(this.origin.x,this.origin.y).setPosition(0,0).setScale(1,1).setAngle(i.angle).setAlpha(i.alpha).hide(),this.group.addChild(this.sprite),this.wrapper=new h(this,this.manager)}var t,i;return t=e,(i=[{key:"destroy",value:function(){this.wrapper.destroy();var e=this.component.layers.indexOf(this);return e>=0&&this.component.layers.splice(e,1),this.group.remove(this.sprite),this.sprite.destroy(),this}},{key:"play",value:function(e,t,i){var n=this.animations[e];return!0===i&&(this.stop(),this.hide()),n?(this.wrapper.play(n,t,i),this.show()):(this.stop(),this.hide()),this}},{key:"stop",value:function(e){var t=this.animations[e];return this.wrapper.stop(t),this}},{key:"hide",value:function(){return this.sprite.visible=!1,this}},{key:"show",value:function(){return this.sprite.visible=!0,this}},{key:"setAlpha",value:function(e){return this.sprite.alpha="number"==typeof e?e:this.sprite.alpha||0,this}},{key:"setTint",value:function(e){return this.sprite.tint="number"==typeof e?e:this.sprite.tint||16777215,this}},{key:"setHue",value:function(e,t){var i="number"==typeof t?t:1,n="number"==typeof e?e:1,s=Math.floor(i*v(n,.166,.25)),r=Math.floor(i*v(n,.5,.25)),a=Math.floor(i*v(n,.833,.25));return this.sprite.tint=(s<<16)+(r<<8)+a,this}},{key:"setIllumination",value:function(e){var t=Number.parseInt(255*("number"==typeof e?e:1));return this.sprite.tint=(t<<16)+(t<<8)+t,this}},{key:"setAngle",value:function(e){return this.sprite.angle="number"==typeof e?e:this.sprite.angle||0,this}},{key:"setBlendMode",value:function(e){var t=PIXI.BLEND_MODES[e]||PIXI.BLEND_MODES.NORMAL;return this.sprite.blendMode=t,this}},{key:"setPosition",value:function(e,t){return this.sprite.x=this.position.x+("number"==typeof e?e:this.sprite.x||0),this.sprite.y=this.position.y+("number"==typeof t?t:this.sprite.y||0),this}},{key:"setScale",value:function(e,t){return this.sprite.scale.x=this.scale.x*("number"==typeof e?e:1),this.sprite.scale.y=this.scale.y*("number"==typeof t?t:e),this}},{key:"setOrigin",value:function(e,t){return this.sprite.anchor.x="number"==typeof e?e:.5,this.sprite.anchor.y="number"==typeof t?t:this.sprite.anchor.x,this}},{key:"setText",value:function(e){return["number","string"].indexOf(S(e))<0&&(e=""),this.sprite.text=e.toString(),this}},{key:"setFrame",value:function(){return this}},{key:"setTexture",value:function(){return this}},{key:"setTiles",value:function(){return this}}])&&O(t.prototype,i),e}();function P(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var j=function(){function e(t,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.component=t,this.factory=t.factory,this.game=this.factory.game,this.app=this.factory.app,this.manager=t.manager,this.group=t.group,this.config=i,this.scale={x:i.scale?"number"==typeof i.scale?i.scale:i.scale.x?i.scale.x:1:1,y:i.scale?"number"==typeof i.scale?i.scale:i.scale.y?i.scale.y:1:1},this.position={x:i.position?"number"==typeof i.position?i.position:i.position.x?i.position.x:0:0,y:i.position?"number"==typeof i.position?0:i.position.y?i.position.y:0:0},this.animations=i.animations,this.layerName=i.layerName,this.layerType="component",this.subcomponent=this.factory.getComponent(i.componentName),this.group.addChild(this.subcomponent.group),this.setScale(1,1).setAngle(i.angle).setAlpha(i.alpha).setPosition(0,0).hide(),this.wrapper=new h(this,this.manager)}var t,i;return t=e,(i=[{key:"destroy",value:function(){this.wrapper.destroy();var e=this.component.layers.indexOf(this);return e>=0&&this.component.layers.splice(e,1),this.group.remove(this.subcomponent.group),this.subcomponent.destroy(),this}},{key:"play",value:function(e,t,i){var n=this.animations[e];return!0===i&&(this.stop(),this.hide()),n?(this.wrapper.play(n,t,i),this.show()):(this.stop(e),this.hide()),this}},{key:"stop",value:function(e){var t=this.animations[e];return this.wrapper.stop(t),this}},{key:"hide",value:function(){return this.subcomponent.hide(),this}},{key:"show",value:function(){return this.subcomponent.show(),this}},{key:"setAlpha",value:function(e){return this.subcomponent.setAlpha(e),this}},{key:"setTint",value:function(e){return this.subcomponent.setTint(e),this}},{key:"setHue",value:function(e,t){return this.subcomponent.setHue(e,t),this}},{key:"setIllumination",value:function(e){return this.subcomponent.setIllumination(e),this}},{key:"setAngle",value:function(e){return this.subcomponent.setAngle(e),this}},{key:"setBlendMode",value:function(e){return this.subcomponent.setBlendMode(e),this}},{key:"setPosition",value:function(e,t){return e=this.position.x+("number"==typeof e?e:this.sprite.x||0),t=this.position.y+("number"==typeof t?t:this.sprite.y||0),this.subcomponent.setPosition(e,t),this}},{key:"setScale",value:function(e,t){return e="number"==typeof e?e:1,t="number"==typeof t?t:e,this.subcomponent.setScale(this.component.scale.x*this.scale.x*e,this.component.scale.y*this.scale.y*t),this}},{key:"setOrigin",value:function(e,t){return this}},{key:"setTiles",value:function(e,t){return this}},{key:"setFrame",value:function(){return this}},{key:"setTexture",value:function(){return this}},{key:"setText",value:function(){return this}}])&&P(t.prototype,i),e}();function M(e){return(M="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function E(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var C=function(){function e(t,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.component=t,this.factory=t.factory,this.game=this.factory.game,this.scene=t.scene,this.manager=t.manager,this.group=t.group,this.config=i,console.log("ComponentLayerBitmapText.constructor"),this.scale={x:i.scale?"number"==typeof i.scale?i.scale:i.scale.x?i.scale.x:1:1,y:i.scale?"number"==typeof i.scale?i.scale:i.scale.y?i.scale.y:1:1},this.position={x:i.position?"number"==typeof i.position?i.position:i.position.x?i.position.x:0:0,y:i.position?"number"==typeof i.position?0:i.position.y?i.position.y:0:0},this.origin={x:"number"==typeof i.origin?i.origin:"object"===M(i.origin)&&"number"==typeof i.origin.x?i.origin.x:.5,y:"number"==typeof i.origin?i.origin:"object"===M(i.origin)&&"number"==typeof i.origin.y?i.origin.y:.5},this.style="object"===M(i.style)?i.style:{},this.animations=i.animations,this.layerName=i.layerName,this.sprite=new PIXI.BitmapText(i.text,this.style),this.setText(i.text).setOrigin(this.origin.x,this.origin.y).setPosition(0,0).setScale(1,1).setAngle(i.angle).setAlpha(i.alpha).hide(),this.group.addChild(this.sprite),this.wrapper=new h(this,this.manager)}var t,i;return t=e,(i=[{key:"destroy",value:function(){this.wrapper.destroy();var e=this.component.layers.indexOf(this);return e>=0&&this.component.layers.splice(e,1),this.group.remove(this.sprite),this.sprite.destroy(),this}},{key:"play",value:function(e,t,i){var n=this.animations[e];return!0===i&&(this.stop(),this.hide()),n?(this.wrapper.play(n,t,i),this.show()):(this.stop(),this.hide()),this}},{key:"stop",value:function(e){var t=this.animations[e];return this.wrapper.stop(t),this}},{key:"hide",value:function(){return this.sprite.visible=!1,this}},{key:"show",value:function(){return this.sprite.visible=!0,this}},{key:"setAlpha",value:function(e){return this.sprite.alpha="number"==typeof e?e:this.sprite.alpha||0,this}},{key:"setTint",value:function(e){return this.sprite.tint="number"==typeof e?e:this.sprite.tint||16777215,this}},{key:"setHue",value:function(e,t){var i="number"==typeof t?t:1,n="number"==typeof e?e:1,s=Math.floor(i*v(n,.166,.25)),r=Math.floor(i*v(n,.5,.25)),a=Math.floor(i*v(n,.833,.25));return this.sprite.tint=(s<<16)+(r<<8)+a,this}},{key:"setIllumination",value:function(e){var t=Number.parseInt(255*("number"==typeof e?e:1));return this.sprite.tint=(t<<16)+(t<<8)+t,this}},{key:"setAngle",value:function(e){return this.sprite.angle="number"==typeof e?e:this.sprite.angle||0,this}},{key:"setBlendMode",value:function(e){var t=PIXI.BLEND_MODES[e]||PIXI.BLEND_MODES.NORMAL;return this.sprite.blendMode=t,this}},{key:"setPosition",value:function(e,t){return this.sprite.x=this.position.x+("number"==typeof e?e:this.sprite.x||0),this.sprite.y=this.position.y+("number"==typeof t?t:this.sprite.y||0),this}},{key:"setScale",value:function(e,t){return this.sprite.scale.x=this.scale.x*("number"==typeof e?e:1),this.sprite.scale.y=this.scale.y*("number"==typeof t?t:e),this}},{key:"setOrigin",value:function(e,t){return this.sprite.anchor.x="number"==typeof e?e:.5,this.sprite.anchor.y="number"==typeof t?t:this.sprite.anchor.x,this}},{key:"setText",value:function(e){return["number","string"].indexOf(M(e))<0&&(e=""),this.sprite.setText(e.toString()),this}},{key:"setFrame",value:function(){return this}},{key:"setTexture",value:function(){return this}},{key:"setTiles",value:function(){return this}}])&&E(t.prototype,i),e}();function I(e){return(I="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function R(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var F=function(){function e(t,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.game=t.game,this.app=t.app,this.factory=t,this.config=i,this.manager=i.manager,this.wrapper=new h(this,this.manager),this.callbacks={},this.sounds=this.config.sounds||{},this.events=[],this.inputHandlers=[],this.component=this,this.group=new PIXI.Container,Array.isArray(i.on)&&i.on.length&&(this.inputHandlers=i.on.filter((function(e){return!(!e.name||"string"!=typeof e.name||!e.listener||"function"!=typeof e.listener||(e.name=e.name.toLocaleLowerCase(),["down","over","out","up"].indexOf(e.name)<0))}))),this.inputHandlers&&this.inputHandlers.length&&(this.group.interactive=!0,this.inputHandlers.forEach((function(e){var t=e.listener.bind(this);this.group.on("pointer"+e.name,t)}),this)),this.scale={x:i.scale?"number"==typeof i.scale?i.scale:i.scale.x?i.scale.x:1:1,y:i.scale?"number"==typeof i.scale?i.scale:i.scale.y?i.scale.y:1:1},this.position={x:i.position?"number"==typeof i.position?i.position:i.position.x?i.position.x:0:0,y:i.position?"number"==typeof i.position?0:i.position.y?i.position.y:0:0},this.componentName=i.name,this.constructLayer(),this.layersMap={},this.layers=i.layers.filter((function(e,t){return!!e.layerName&&!!e.animations&&!!Object.keys(e.animations).length}),this).map((function(e){if("text"===e.layerType){var t=new A(this,e);return this.layersMap[e.layerName]=t,t}if("bitmaptext"===e.layerType){if(!e.fontName)return!1;var i=new C(this,e);return this.layersMap[e.layerName]=i,i}if("tile"===e.layerType){if(!e.spriteName)return!1;var n=new T(this,e);return this.layersMap[e.layerName]=n,n}if("component"===e.layerType){if(!e.componentName)return!1;if(!this.factory.componentsConfig[e.componentName])return!1;var s=new j(this,e);return this.layersMap[e.layerName]=s,s}if(!e.spriteName)return!1;var r=new k(this,e);return this.layersMap[e.layerName]=r,r}),this).filter((function(e,t){return!!e}),this),i.events&&this.factory.game.once&&this.factory.game.on&&this.factory.game.emit&&(this.events=i.events.map((function(e){var t=e.listener.bind(this);return this.factory.game.on(e.name,t),{name:e.name,listener:t}}),this)),this.setPosition(0,0),this.setScale(1)}var t,i;return t=e,(i=[{key:"addToGroup",value:function(e){return e.addChild(this.group),this}},{key:"constructLayer",value:function(){var e={};Object.keys(this.config.compositions).forEach((function(t){Object.keys(this.config.compositions[t]).forEach((function(i){e[i]=e[i]||{},e[i][t]=this.config.compositions[t][i]}),this)}),this),this.config.layers.forEach((function(t){t.animations=e[t.layerName]}),this),this.config.animations=e.GROUP}},{key:"getDuration",value:function(e){var t=this.config.compositions[e];if(!t)return 0;var i=0;return Object.values(t).some((function(e){var t=this.config.manager.presets[e];return!!t&&t.some((function(e){if(!e)return!1;if(0===e.loop)return i=1/0,!0;var t=(e.delay||0)+(e.time||0)*(e.loop||0);return i<t&&(i=t),!1}),this)}),this),i}},{key:"play",value:function(){for(var e,t,i,n,s=arguments.length,r=new Array(s),a=0;a<s;a++)r[a]=arguments[a];if(r.forEach((function(s){"string"!=typeof s?"object"!==I(s)||Array.isArray(s)?"boolean"!=typeof s?"function"!=typeof s||void 0===n&&(n=s):void 0===i&&(i=s):void 0===t&&(t=s):void 0===e&&(e=s)}),this),!e||!this.config.compositions[e])return this.hide(),this;if(this.show(),this.currentAnimation=e,this.layers.forEach((function(n){n.play(e,t,i)}),this),this.config.animations){var o=this.config.animations[e];!0===i&&this.wrapper.stop(),o&&this.wrapper.play(o,t,i)}if("function"!=typeof n)return this;var l=this.getDuration(e);return l===1/0?this:0===l?(n.call(this),this):(this.callbacks[e]=this.callbacks[e]||[],this.callbacks[e].push({compositionName:e,options:t,callback:n}),this.factory.setTimer((function(){this.execCallbacks(e)}),l+1,this),this)}},{key:"stop",value:function(e){if(this.layers.forEach((function(t){t.stop(e)}),this),this.config.animations){var t=this.config.animations[e];this.wrapper.stop(t)}return this.execCallbacks(e),this}},{key:"execCallbacks",value:function(e){if(e){var t=this.callbacks[e];if(void 0===t)return;if(delete this.callbacks[e],!Array.isArray(t)||!t.length)return;t.forEach((function(e){"function"==typeof e.callback&&e.callback.call(this)}),this)}else{if(void 0===this.callbacks)return;var i=Object.values(this.callbacks);this.callbacks={},i.forEach((function(e){Array.isArray(e)&&e.length&&e.forEach((function(e){"function"==typeof e.callback&&e.callback.call(this)}),this)}),this)}}},{key:"destroy",value:function(){if(!this.isDestroy){this.isDestroy=!0,this.wrapper.destroy();var e=this.factory.components.indexOf(this);e>=0&&this.factory.components.splice(e,1),this.layers.slice(0).forEach((function(e){e.destroy()}),this),this.events.forEach((function(e){this.factory.game.removeListener(e.name,e.listener)}),this),this.group.interactive=!1,this.group.destroy(),delete this.factory,delete this.game,delete this.app,delete this.config,delete this.manager,delete this.wrapper,delete this.events,delete this.group,delete this.callbacks,delete this.sounds}}},{key:"hide",value:function(){return this.group.visible=!1,this}},{key:"show",value:function(){return this.group.visible=!0,this}},{key:"setAlpha",value:function(e){return this.group.alpha="number"==typeof e?e:this.group.alpha||0,this}},{key:"setTint",value:function(e){return this.layers.forEach((function(t){t.sprite.tint=e}),this),this}},{key:"setHue",value:function(e,t){var i="number"==typeof t?t:1,n="number"==typeof e?e:1,s=(Math.floor(i*v(n,.166,.25))<<16)+(Math.floor(i*v(n,.5,.25))<<8)+Math.floor(i*v(n,.833,.25));return this.layers.forEach((function(e){e.sprite.tint=s}),this),this}},{key:"setIllumination",value:function(e){return this.layers.forEach((function(t){t.setIllumination(e)}),this),this}},{key:"setAngle",value:function(e){return this.group.angle="number"==typeof e?e:this.group.angle||0,this}},{key:"setBlendMode",value:function(e){return this.layers.forEach((function(t){t.setBlendMode(e)}),this),this}},{key:"setPosition",value:function(e,t){return this.group.x="number"==typeof e?this.position.x+e:this.group.x||0,this.group.y="number"==typeof t?this.position.y+t:this.group.y||0,this}},{key:"setScale",value:function(e,t){return this.group.scale.x=this.scale.x*("number"==typeof e?e:1),this.group.scale.y=this.scale.y*("number"==typeof t?t:e),this}},{key:"setOrigin",value:function(e,t){return this}},{key:"setTiles",value:function(e,t){return this}},{key:"setFrame",value:function(){return this}},{key:"setTexture",value:function(){return this}},{key:"setText",value:function(){return this}}])&&R(t.prototype,i),e}();function B(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var D=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.timers={},this.index=0,this.multiplier=1,this.divider=1/this.multiplier,this.timer=0,this.oldTime=0}var t,i;return t=e,(i=[{key:"setSpeed",value:function(e){"number"==typeof e&&(this.multiplier=e,this.divider=1/this.multiplier)}},{key:"update",value:function(e){this.timerProcess||(this.timerProcess=!0,this.timer+=e*this.multiplier,Object.values(this.timers).forEach((function(e){e.time>this.timer||(delete this.timers[e.index],"function"==typeof e.callback&&e.callback.call(e.context||null))}),this),this.timerProcess=!1)}},{key:"setTimer",value:function(e,t,i){return"function"!=typeof e||"number"!=typeof t||(i||(i=null),this.index++,this.timers[this.index]={index:this.index,time:this.timer+t,callback:e,context:i}),this}},{key:"removeTimer",value:function(e){if("function"!=typeof e)return this;var t=0;return Object.values(this.timers).forEach((function(i){i.callback===e&&(delete this.timers[i.index],t++)}),this),t}}])&&B(t.prototype,i),e}();function L(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var U=function(){function e(t,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.game=t,this.app=t.app,this.resourcesPath=i||"/",this.managers=[],this.frames={},this.components=[],this.componentsConfig={},this.sounds={},this.timer=new D,this.loadedResources={},this.loadedComponents={},this.loadedSounds={},this.promises=[],configurations.getConfigByType("component").forEach((function(e){this.addComponentConfig(e)}),this),this.game.once&&this.game.on&&this.game.on("game.update",this._update,this)}var t,i;return t=e,(i=[{key:"_update",value:function(e,t){this.managers.forEach((function(t){t.update(e)}),this),this.game.timer||"function"==typeof this.game.on||this.timer.update(e)}},{key:"parseConfig",value:function(e){Array.isArray(e.sprites)&&e.sprites.forEach((function(e){if(e.url&&e.name)if(void 0===this.loadedResources[e.name])this.loadedResources[e.name]=e.url,this.app.loader.add(e.name,this.resourcesPath+e.url);else if(this.loadedResources[e.name]!==e.url)throw"Вы пытаетесь загрузить '".concat(e.url,"' под именем '").concat(e.name,"', но для данного имени уже загружен другой ресурс '").concat(this.loadedResources[e.name],"'")}),this),Array.isArray(e.audio)&&e.audio.forEach((function(e){if(e.url&&e.name)if(void 0===this.loadedSounds[e.name])this.loadedSounds[e.name]=e.url,PIXI.sound.add(e.name,{url:this.resourcesPath+e.url,preload:!0});else if(this.loadedSounds[e.name]!==e.url)throw"Вы пытаетесь загрузить '".concat(e.url,"' под именем '").concat(e.name,"', но для данного имени уже загружен другой ресурс '").concat(this.loadedResources[e.name],"'")}),this),Array.isArray(e.animators)&&e.animators.forEach((function(t){e.manager.addAnimator(t.name,t.handler)}),this),Array.isArray(e.presets)&&e.presets.forEach((function(t){e.manager.addPreset(t.name,t.params)}),this)}},{key:"addComponentConfig",value:function(e){if(!e.type||"component"!==e.type)throw'Тип подключаемого конфигурациюнного файла не "component"';if(!e.name)throw"У компонента не задано имя. Укажите его в конфигурационном файле компонента в свойстве name";return this.componentsConfig[e.name]&&console.warn("Cимвол c именем "+e.name+" уже загружен, проверьте, что у вас нет 2-х разных компонентов с одним именем"),e.sprites||(e.sprites=[]),e.components||(e.components=[]),e.audio||(e.audio=[]),e.sounds||(e.sounds={}),e.compositions||(e.compositions={}),e.layers||(e.layers=[]),e.presets||(e.presets=[]),e.animators||(e.animators=[]),e.events||(e.events=[]),e.manager=new g(this.scene),this.componentsConfig[e.name]=e,this.managers.push(e.manager),this.parseConfig(e),this}},{key:"getComponent",value:function(e){var t=this.componentsConfig[e];if(!t)throw'Не найдена конфигурация для "'+e+'". Добавить ее вы можете в секции GameClient.preload командой ComponentsFactory.addComponentConfig(name, config)';t.sounds=this.sounds;var i=new F(this,t);return this.components.push(i),t.startComposition&&i.play(t.startComposition,!0),i}},{key:"destroy",value:function(){this.manager.stop(),this.manager.destroy(),this.components.forEach((function(e){e.destroy()}))}}])&&L(t.prototype,i),e}();function X(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function G(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var H=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;X(this,e),this.seed=t,this.p1=2654435761,this.p2=2246822519,this.p3=3266489917,this.p4=668265263,this.p5=374761393,this.p=[this.p1,this.p2,this.p3,this.p4,this.p5],this.cut=4294967295,this.getValue=this._GetXxHash}var t,i;return t=e,(i=[{key:"_RotateLeft",value:function(e,t){return e<<t|e>>>32-t}},{key:"_CalcSubHash",value:function(e,t){return e+=t*this.p2,(e=this._RotateLeft(e,13))*this.p1}},{key:"_GetXxHash",value:function(){for(var e,t=0,i=arguments.length,n=new Array(i),s=0;s<i;s++)n[s]=arguments[s];var r=n.length;if(r>=4){for(var a=r-4,o=this.seed+this.p1+this.p2,l=this.seed+this.p2,u=this.seed+0,p=this.seed-this.p1;t<=a;)o=this._CalcSubHash(o,n[t]),t++,l=this._CalcSubHash(l,n[t]),t++,u=this._CalcSubHash(u,n[t]),t++,p=this._CalcSubHash(p,n[t]),t++;e=this._RotateLeft(o,1)+this._RotateLeft(l,7)+this._RotateLeft(u,12)+this._RotateLeft(p,18)}else e=this.seed+this.p5;for(e+=4*r;t<r;)e+=n[t]*this.p3,e=this._RotateLeft(e,17)*this.p4,t++;return e^=e>>>15,e*=this.p2,e^=e>>>13,e*=this.p3,((e^=e>>>16)>>>0)/4294967295}}])&&G(t.prototype,i),e}();function z(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Y=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.world=t,this.game=t.game,this.app=t.app,this.factory=t.game.factory,this.group=t.group||this.app.stage,this.game.once&&this.game.on&&(this.game.once("game.preload",this._preload,this),this.game.once("game.create",this._create,this),this.game.on("game.update",this._update,this)),this.force=0}var t,i;return t=e,(i=[{key:"_preload",value:function(){}},{key:"_create",value:function(){this.rabbit=this.factory.getComponent("RABBIT").setPosition(450,0).addToGroup(this.group).play("normal")}},{key:"_update",value:function(e,t){if(this.world.isStarted){if(this.force>0)this.rabbit.group.y-=this.force*t,this.force-=t,this.force=this.force<0?0:this.force;else if(this.force<0)this.rabbit.group.y-=this.force*t;else{var i=300/(this.rabbit.group.y<-1?-this.rabbit.group.y:1);this.rabbit.group.y+=i}this.rabbit.group.y>0&&(this.rabbit.play("normal",!0),this.force=0,this.rabbit.group.y=0)}}},{key:"jump",value:function(){this.rabbit.group.y<0?(this.rabbit.play("normal",!0),this.force=-12):(this.force=16,this.rabbit.play("fly",!0))}},{key:"reset",value:function(){this.rabbit.group.y=0,this.rabbit.play("normal",!0)}}])&&z(t.prototype,i),e}();function W(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Z=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.world=t,this.game=t.game,this.app=t.game.app,this.game.once&&this.game.on&&(this.game.once("game.preload",this._preload,this),this.game.once("game.create",this._create,this),this.game.on("game.update",this._update,this)),this.list=[]}var t,i;return t=e,(i=[{key:"_preload",value:function(){this.app.loader.add("stopper","./images/stopper_idle.png")}},{key:"_create",value:function(){this.reset()}},{key:"_update",value:function(e,t){var i=this;if(this.world.isStarted){var n=!1;this.list=this.list.filter((function(e){return e.oldX=e.x,e.x-=i.world.speed*t,e.x<i.world.length&&e.oldX>=i.world.length&&(n=!0),e.x+e.width<=0?(i.world.rounddata.stoppers++,e.destroy(),!1):(i.testCollisions(e)&&i.world.break(),!0)})),n&&this.newStopper()}}},{key:"reset",value:function(){this.list.forEach((function(e){e.destroy()})),this.list=[],this.newStopper()}},{key:"newStopper",value:function(){var e=this.game._getSprite("stopper");e.scale.set(.5),e.anchor.x=.5,e.anchor.y=1,e.x=this.world.length+this.world.length/2+2*Math.random()*this.world.length,e.y=5,this.list.push(e),this.world.group.addChild(e)}},{key:"testCollisions",value:function(e){var t=this.world.rabbit.rabbit.group;return!(Math.abs(e.x-t.x)>.8*e.width||t.y<e.y-.8*e.height)}}])&&W(t.prototype,i),e}();function K(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var J=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.world=t,this.game=t.game,this.app=t.game.app,this.game.once&&this.game.on&&(this.game.once("game.preload",this._preload,this),this.game.once("game.create",this._create,this),this.game.on("game.update",this._update,this)),this.list=[]}var t,i;return t=e,(i=[{key:"_preload",value:function(){this.app.loader.add("tree1","./images/street_tree.png").add("tree2","./images/tree_2.png")}},{key:"_create",value:function(){}},{key:"_update",value:function(e,t){var i=this;this.world.isStarted&&(this.list=this.list.filter((function(e){return e.x-=i.world.speed*t,e.x+e.width>0||(e.destroy(),!1)})))}},{key:"reset",value:function(){this.list.forEach((function(e){e.destroy()})),this.list=[]}},{key:"newTree",value:function(){var e=Math.ceil(2*Math.random()),t=this.game._getSprite("tree"+e);t.scale.set(.5+Math.random()),t.anchor.x=0,t.anchor.y=1,t.x=this.world.length,t.y=3,this.list.push(t),this.world.backgroundGroup.addChild(t)}}])&&K(t.prototype,i),e}();function $(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Q=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.game=t,this.app=t.app,this.PRNG=new H(0),this.game.once&&this.game.on&&(this.game.once("game.preload",this._preload,this),this.game.once("game.create",this._create,this),this.game.on("game.update",this._update,this)),this.skyGroup=new PIXI.Container,this.app.stage.addChild(this.skyGroup),this.group=new PIXI.Container,this.app.stage.addChild(this.group),this.backgroundGroup=new PIXI.Container,this.group.addChild(this.backgroundGroup),this.stoppers=new Z(this),this.trees=new J(this),this.rabbit=new Y(this),this.minSpeed=0,this.maxSpeed=16,this.minAngle=0,this.maxAngle=8,this.position=0,this.count=0,this.reset()}var t,i;return t=e,(i=[{key:"_preload",value:function(){this.app.loader.add("sky","./images/sky.jpeg").add("floor","./images/floor.png")}},{key:"_create",value:function(){var e=this;this.floor=this.game._getTillingSprite("floor",0,2*Math.hypot(this.app.screen.height,this.app.screen.width),414),this.floor.scale.set(.5,1),this.floor.x=0,this.floor.y=0,this.floor.tilePosition.x=0,this.floor.tilePosition.y=-1,this.group.addChild(this.floor),this.sky=this.game._getTillingSprite("sky",0,this.app.screen.width,this.app.screen.height),this.sky.x=0,this.sky.y=0,this.sky.tilePosition.x=0,this.sky.tilePosition.y=0,this.sky.scale.set(this.app.screen.width/1005),this.skyGroup.addChild(this.sky),this.app.stage.interactive=!0,this.app.stage.on("pointerdown",(function(){e.isActive&&e.start()})),this.game.on("ui.open.*",(function(){e.isActive=!1}))}},{key:"_update",value:function(e,t){if(this.isStarted){this.position-=this.speed*t*2,this.floor.tilePosition.x=this.position,this.sky.tilePosition.x-=this.speed*t/20;var i=Math.floor(this.position/200);this.count!==i&&Math.random()>.34&&this.trees.newTree(),this.count=i,this.rounddata.distance=Math.abs(Math.floor(this.position/150)),this.rounddata.score=this.rounddata.distance+2*this.rounddata.stoppers}}},{key:"setSpeed",value:function(e){this.speed=Math.max(this.minSpeed,Math.min(this.maxSpeed,e)),this.angle=180*Math.asin(this.speed/this.maxSpeed)/Math.PI*this.maxAngle/90,this.group.angle=this.angle;var t=this.app.screen.width*Math.sin(this.angle*Math.PI/180);this.length=Math.hypot(this.app.screen.width,t),this.group.y=this.app.screen.height-t-50}},{key:"reset",value:function(){this.position=0,null!=this&&this.floor&&(this.floor.tilePosition.x=this.position),this.setSpeed(16),this.isBreak&&(this.stoppers.reset(),this.trees.reset(),this.rabbit.reset()),this.rounddata={stoppers:0,money:0,distance:0,score:0},this.isStarted=!1,this.isBreak=!1,this.isActive=!0,this.game.keyboard.setListeners({SPACE:this.start.bind(this),ESCAPE:this.stop.bind(this)},this)}},{key:"start",value:function(){this.isStarted&&this.rabbit.jump(),this.isStarted=!0}},{key:"stop",value:function(){this.isStarted=!1}},{key:"break",value:function(){this.isStarted=!1,this.isBreak=!0,this.game.emit("ui.close"),this.game.emit("ui.open.youscore",this.rounddata)}}])&&$(t.prototype,i),e}();function V(e){return(V="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function q(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var ee=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.keys={},this.listeners={},window.addEventListener("keydown",this.downListener.bind(this),!1),window.addEventListener("keyup",this.upListener.bind(this),!1)}var t,i;return t=e,(i=[{key:"setListeners",value:function(e,t){e&&"object"===V(e)&&(t||(t=null),this.listeners={},Object.keys(e).forEach((function(i){"function"==typeof e[i]&&(this.listeners[i]=function(i){e[i].call(t,i)})}),this))}},{key:"downListener",value:function(e){var t=e.code.replace(/^(Key|Digit)/i,"").toUpperCase();this.keys[t]||(this.keys[t]=!0,this.listeners[t]&&this.listeners[t](t))}},{key:"upListener",value:function(e){var t=e.code.replace(/^(Key|Digit)/i,"").toUpperCase();this.keys[t]=!1}},{key:"pressListener",value:function(e){}}])&&q(t.prototype,i),e}();function te(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function ie(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?te(Object(i),!0).forEach((function(t){ne(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):te(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function ne(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var se={userdata:{name:"Guest_1234",score:0,money:0,distance:0},leadboard:{alltime:[{name:"Вася Пупкин",score:99999},{name:"Петя машечкин",score:88888},{name:"Павлик Морозов",score:77777},{name:"Костя Беc",score:66666},{name:"Черная Баронесса",score:55555},{name:"Владимир Владимирович",score:44444},{name:"Лунтик",score:33333},{name:"Медвед",score:22222},{name:"123",score:11111},{name:"test",score:0}],month:[],week:[]}},re=localStorage.getItem("userdata");re&&(se=JSON.parse(re)),localStorage.setItem("userdata",JSON.stringify(se));var ae={"https://lastuniverse.ru/pixi.js/api/leadboard":{GET:function(e){return se.leadboard[e.interval]||[]}},"https://lastuniverse.ru/pixi.js/api/user":{GET:function(e){return se.userdata},POST:function(e){return se.userdata=ie(ie({},se.userdata),e),localStorage.setItem("userdata",JSON.stringify(se)),{success:!0}}}};function oe(e,t,i,n){var s;null!=ae&&null!==(s=ae[e])&&void 0!==s&&s[t]?setTimeout((function(){var s=ae[e][t](i);n(s)}),1e3*Math.random()):setTimeout((function(){n({error:404})}),1e3*Math.random())}function le(e){return(le="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ue(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var pe=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.list=[]}var t,i;return t=e,(i=[{key:"replace",value:function(e){if("object"!==le(e)||Array.isArray(e))throw"Конфигурация должна быть объектом";if("string"!=typeof e.name||!e.name)throw"Объект с конфигурацией должен содержать свойство name";var t;this.list.some((function(i,n){return i.name===e.name&&(t=n,!0)}),this),void 0!==t&&this.list.splice(t,1),this.list.push(e)}},{key:"remove",value:function(e){if("object"!==le(e)||Array.isArray(e))throw"Конфигурация должна быть объектом";if("string"!=typeof e.name||!e.name)throw"Объект с конфигурацией должен содержать свойство name";var t;this.list.some((function(i,n){return i.name===e.name&&(t=n,!0)}),this),void 0!==t&&this.list.splice(t,1),this.list.push(e)}},{key:"removeByName",value:function(e){var t;"string"==typeof e&&e&&(this.list.some((function(i,n){return i.name===e&&(t=n,!0)}),this),void 0!==t&&this.list.splice(t,1))}},{key:"add",value:function(e){if("object"!==le(e)||Array.isArray(e))throw"Конфигурация должна быть объектом";if("string"!=typeof e.name||!e.name)throw"Объект с конфигурацией должен содержать свойство name";if(this.getConfigByName(e.name))throw'Конфигурация для "'+e.name+'" уже подключена, перепроверьте ваши данные';this.list.push(e)}},{key:"getConfigByName",value:function(e){return e?this.list.find((function(t){return t.name===e}),this):null}},{key:"getConfigByType",value:function(e){return e?this.list.filter((function(t){return t.type===e}),this):[]}},{key:"getConfigByGroupName",value:function(e){return e?this.list.filter((function(t){return t.group===e}),this):[]}},{key:"getConfigByTypeAndGroupName",value:function(e,t){return e&&t?this.list.filter((function(i){return i.group===t&&i.type===e}),this):[]}}])&&ue(t.prototype,i),e}();window.configurations||(window.configurations=new pe);const he={type:"component",name:"RABBIT",sprites:[{name:"entity_rabbit",url:"/rabbit/rabbit.json"}],audio:[],startComposition:"normal",scale:{x:.5,y:.5},position:{x:0,y:0},compositions:{normal:{rabbit:"normal"},fly:{rabbit:"fly",distance:"update"}},layers:[{layerType:"sprite",layerName:"rabbit",spriteName:"entity_rabbit",frameName:"normal",origin:{x:.5,y:1}},{layerType:"text",layerName:"distance",origin:{x:.5,y:.5},scale:1,position:{x:20,y:20},angle:-8,text:"---\n",style:{fontFamily:"Zubilo Black",fontSize:80,fill:11141120,align:"center",fontWeight:200}}],presets:[{name:"normal",params:[{time:1,name:"animate_reset",loop:1,frame:"normal"}]},{name:"fly",params:[{time:1,name:"animate_reset",loop:1,frame:"up"}]},{name:"update",params:[{time:1,name:"update_text",loop:0}]}],animators:[{name:"animate_reset",handler:function(e,t,i,n){i.sprite?t.setTexture(i.sprite,i.frame):i.frame&&t.setFrame(i.frame),i.frameName&&t.setFrame(i.frameName),"number"==typeof i.scale?t.setScale(i.scale):"object"==typeof i.scale&&t.setScale(i.scale.x,i.scale.y),"number"==typeof i.alpha&&t.setAlpha(i.alpha),"number"==typeof i.angle&&t.setAngle(i.angle)}},{name:"animate_frames",handler:function(e,t,i,n){const s="number"==typeof i.from?i.from:0,r=("number"==typeof i.to?i.to:i.frames.length)-s,a=s+Math.floor(e*r),o=i.frames[a];i.sprite?t.setTexture(i.sprite,o):t.setFrame(o)}},{name:"animate_scale",handler:function(e,t,i,n){const s="number"==typeof i.from?i.from:0,r=s+e*(("number"==typeof i.to?i.to:1)-s);t.setScale(r)}},{name:"animate_alpha",handler:function(e,t,i,n){const s="number"==typeof i.from?i.from:0,r=s+e*(("number"==typeof i.to?i.to:1)-s);t.setAlpha(r)}},{name:"animate_rotate",handler:function(e,t,i,n){const s="number"==typeof i.from?i.from:0,r=s+e*(("number"==typeof i.to?i.to:360)-s);t.setAngle(r)}},{name:"update_text",handler:function(e,t,i,n){t.setText(t.game.world.rounddata.distance)}}],events:[]};configurations.add(he);const ce={type:"component",name:"UI_FORM_LEADBOARD_BUTTON_LEFT",sprites:[{name:"ui_elements",url:"/ui/ui.json"}],audio:[{name:"sound_button_press",url:"/ui/joystick-trigger-button.mp3"}],startComposition:"active",scale:{x:-1,y:1},position:{x:0,y:0},compositions:{active:{button:"active"},hover:{button:"hover"},press:{button:"press"}},layers:[{layerType:"sprite",layerName:"button",spriteName:"ui_elements",frameName:"arrow_btn_active"}],presets:[{name:"active",params:[{time:1,name:"animate_reset",frameName:"arrow_btn_active",loop:1}]},{name:"hover",params:[{time:1,name:"animate_reset",frameName:"arrow_btn_hover",loop:1}]},{name:"press",params:[{time:1,name:"animate_reset",frameName:"arrow_btn_press",loop:1}]}],animators:[{name:"animate_reset",handler:function(e,t,i,n){i.sprite?t.setTexture(i.sprite,i.frame):i.frame&&t.setFrame(i.frame),i.frameName&&t.setFrame(i.frameName),"number"==typeof i.dy&&t.setPosition(null,i.dy),i.blendmode&&t.setBlendMode(i.blendmode),"number"==typeof i.scale?t.setScale(i.scale):"object"==typeof i.scale&&t.setScale(i.scale.x,i.scale.y),"number"==typeof i.alpha&&t.setAlpha(i.alpha),"number"==typeof i.angle&&t.setAngle(i.angle)}}],on:[{name:"down",listener:function(){this.play("press",!0),PIXI.sound.play("sound_button_press")}},{name:"up",listener:function(){this.play("hover",!0),this.game.emit("ui.close"),this.game.emit("ui.open.leadboard",{turn:"left"})}},{name:"over",listener:function(){this.play("hover",!0)}},{name:"out",listener:function(){this.play("active",!0)}}],events:[]};configurations.add(ce);const me={type:"component",name:"UI_FORM_LEADBOARD_BUTTON_OK",sprites:[{name:"ui_elements",url:"/ui/ui.json"}],audio:[{name:"sound_button_press",url:"/ui/joystick-trigger-button.mp3"}],startComposition:"active",scale:{x:1,y:1},position:{x:0,y:0},compositions:{active:{button:"active"},hover:{button:"hover"},press:{button:"press"}},layers:[{layerType:"sprite",layerName:"button",spriteName:"ui_elements",frameName:"ok_button_active"}],presets:[{name:"active",params:[{time:1,name:"animate_reset",frameName:"ok_button_active",loop:1}]},{name:"hover",params:[{time:1,name:"animate_reset",frameName:"ok_button_hover",loop:1}]},{name:"press",params:[{time:1,name:"animate_reset",frameName:"ok_button_press",loop:1}]}],animators:[{name:"animate_reset",handler:function(e,t,i,n){i.sprite?t.setTexture(i.sprite,i.frame):i.frame&&t.setFrame(i.frame),i.frameName&&t.setFrame(i.frameName),"number"==typeof i.dy&&t.setPosition(null,i.dy),i.blendmode&&t.setBlendMode(i.blendmode),"number"==typeof i.scale?t.setScale(i.scale):"object"==typeof i.scale&&t.setScale(i.scale.x,i.scale.y),"number"==typeof i.alpha&&t.setAlpha(i.alpha),"number"==typeof i.angle&&t.setAngle(i.angle)}}],on:[{name:"down",listener:function(){this.play("press",!0),PIXI.sound.play("sound_button_press")}},{name:"up",listener:function(){this.play("hover",!0),this.game.emit("ui.close"),this.game.emit("ui.open.myrecords")}},{name:"over",listener:function(){this.play("hover",!0)}},{name:"out",listener:function(){this.play("active",!0)}}],events:[{name:"ui.open.leadboard",listener:function(){this.game.keyboard.setListeners({SPACE:()=>{this.play("press",!0),PIXI.sound.play("sound_button_press"),setTimeout((()=>{this.play("active",!0),this.game.emit("ui.close"),this.game.emit("ui.open.myrecords")}),200)}},this)}}]};configurations.add(me);const fe={type:"component",name:"UI_FORM_LEADBOARD_BUTTON_RIGHT",sprites:[{name:"ui_elements",url:"/ui/ui.json"}],audio:[{name:"sound_button_press",url:"/ui/joystick-trigger-button.mp3"}],startComposition:"active",scale:{x:1,y:1},position:{x:0,y:0},compositions:{active:{button:"active"},hover:{button:"hover"},press:{button:"press"}},layers:[{layerType:"sprite",layerName:"button",spriteName:"ui_elements",frameName:"arrow_btn_active"}],presets:[{name:"active",params:[{time:1,name:"animate_reset",frameName:"arrow_btn_active",loop:1}]},{name:"hover",params:[{time:1,name:"animate_reset",frameName:"arrow_btn_hover",loop:1}]},{name:"press",params:[{time:1,name:"animate_reset",frameName:"arrow_btn_press",loop:1}]}],animators:[{name:"animate_reset",handler:function(e,t,i,n){i.sprite?t.setTexture(i.sprite,i.frame):i.frame&&t.setFrame(i.frame),i.frameName&&t.setFrame(i.frameName),"number"==typeof i.dy&&t.setPosition(null,i.dy),i.blendmode&&t.setBlendMode(i.blendmode),"number"==typeof i.scale?t.setScale(i.scale):"object"==typeof i.scale&&t.setScale(i.scale.x,i.scale.y),"number"==typeof i.alpha&&t.setAlpha(i.alpha),"number"==typeof i.angle&&t.setAngle(i.angle)}}],on:[{name:"down",listener:function(){this.play("press",!0),PIXI.sound.play("sound_button_press")}},{name:"up",listener:function(){this.play("hover",!0),this.game.emit("ui.close"),this.game.emit("ui.open.leadboard",{turn:"right"})}},{name:"over",listener:function(){this.play("hover",!0)}},{name:"out",listener:function(){this.play("active",!0)}}],events:[]};configurations.add(fe);const ye={fontFamily:"Zubilo Black",fontSize:62,fill:15729,align:"center",fontWeight:200},de={fontFamily:"Zubilo Black",fontSize:80,fill:16738305,align:"center",fontWeight:200,dropShadow:!0,dropShadowAngle:Math.PI/2,dropShadowBlur:1,dropShadowDistance:6,dropShadowAlpha:.5},be={fontFamily:"Zubilo Black",fontSize:40,align:"center",fontWeight:200},ge={alltime:"Все время",month:"Месяц",week:"Неделя"},ve={type:"component",name:"UI_FORM_LEADBOARD",sprites:[{name:"ui_sign",url:"/ui/info_plate_big.png"},{name:"ui_elements",url:"/ui/ui.json"}],components:["/ui_form_leadboard_button_ok.js","/ui_form_leadboard_button_left.js","/ui_form_leadboard_button_right.js"],audio:[],position:{x:0,y:0},scale:{x:.66,y:.66},compositions:{base:{background:"base",header:"base",text:"base",load:"base",interval:"base",button:"base"},table:{background:"base",header:"base",text:"base",interval:"base",button:"base"}},layers:[{layerType:"sprite",layerName:"background",spriteName:"ui_sign",frameName:0,origin:.5},{layerType:"sprite",layerName:"header",spriteName:"ui_elements",frameName:"header_info_plate",origin:.5,position:{x:0,y:-408}},{layerType:"text",layerName:"header",origin:{x:.5,y:0},scale:1,position:{x:0,y:-462},text:"Таблица рекордов:\n",style:ye},{layerType:"text",layerName:"load",origin:{x:.5,y:.5},scale:1,position:{x:0,y:0},text:"Загрузка",style:ye},{layerType:"text",layerName:"interval",origin:{x:.5,y:0},scale:1,position:{x:0,y:-370},text:"???\n",style:de},{layerType:"component",layerName:"button",componentName:"UI_FORM_LEADBOARD_BUTTON_OK",scale:1.5,position:{x:0,y:365}},{layerType:"component",layerName:"button",componentName:"UI_FORM_LEADBOARD_BUTTON_LEFT",scale:1.5,position:{x:-280,y:-313}},{layerType:"component",layerName:"button",componentName:"UI_FORM_LEADBOARD_BUTTON_RIGHT",scale:1.5,position:{x:280,y:-313}}],presets:[{name:"base",params:[]}],animators:[{name:"animate_reset",handler:function(e,t,i,n){i.sprite?t.setTexture(i.sprite,i.frame):i.frame&&t.setFrame(i.frame),i.frameName&&t.setFrame(i.frameName),"number"==typeof i.scale?t.setScale(i.scale):"object"==typeof i.scale&&t.setScale(i.scale.x,i.scale.y),"number"==typeof i.alpha&&t.setAlpha(i.alpha),"number"==typeof i.angle&&t.setAngle(i.angle)}},{name:"show_place",handler:function(e,t,i,n){}},{name:"animate_alpha",handler:function(e,t,i,n){const s="number"==typeof i.from?i.from:0,r=s+e*(("number"==typeof i.to?i.to:1)-s);t.setAlpha(r)}}],events:[{name:"ui.close",listener:function(){this.isOpen=!1,this.hide()}},{name:"ui.open.leadboard",listener:function(e={}){this.interval=this.interval||0,"left"===e.turn?this.interval--:"right"===e.turn?this.interval++:this.interval=0,this.interval=(this.interval+3)%3;const t=Object.keys(ge)[this.interval],i=ge[t];this.layersMap.interval.setText(i+"\n"),this.isOpen=!0,this.play("base",!0),this.game.fakeAjax("https://lastuniverse.ru/pixi.js/api/leadboard","GET",{interval:t},(e=>{if(this.isOpen&&t===Object.keys(ge)[this.interval]){for(let t=0;t<10;t++){const i=e[t]||{name:"-",score:"-"};this.layersMap[`place_${t+1}_username`].setText(i.name+"\n"),this.layersMap[`place_${t+1}_score`].setText(i.score+"\n")}this.play("table",!0)}}))}}]};for(let e=0;e<10;e++){const t=70,i="place_"+(e+1),n="show_place_"+(e+1),s=[12673025,2120879,9050624,3355443][Math.min(e,3)],r=["place_1","place_2","place_3","midleader_name_plate"][Math.min(e,3)],a=e<3?"highleader_scores_plate":"midleader_scores_plate",o=e<3?80*e:180+47*(e-2),l=e<3?[-100,250,-265,250]:[-65,250,-265,250,-310],u=e<3?40:36;ve.compositions.table[i]=n,ve.compositions.table[i+"_username"]=n,ve.compositions.table[i+"_score"]=n,ve.presets.push({name:n,params:[{time:1,name:"animate_reset",loop:1,alpha:0},{time:3*t,delay:e*t,name:"animate_alpha",loop:1}]}),ve.layers.push({layerType:"sprite",layerName:i,spriteName:"ui_elements",frameName:r,origin:.5,position:{x:l[0],y:-240+o}},{layerType:"sprite",layerName:i,spriteName:"ui_elements",frameName:a,origin:.5,position:{x:l[1],y:-240+o}},{layerType:"text",layerName:i+"_username",origin:{x:0,y:0},scale:1,position:{x:l[2],y:-265+o},text:"-\n ",style:{...be,fill:s,align:"left",fontSize:u}},{layerType:"text",layerName:i+"_score",origin:{x:.5,y:0},scale:1,position:{x:l[3],y:-265+o},text:"-\n ",style:{...be,fill:s,fontSize:u}}),e>=3&&ve.layers.push({layerType:"text",layerName:i,origin:{x:.5,y:0},scale:1,position:{x:l[4],y:-265+o},text:e+1+"\n ",style:{...be,fill:16777215}})}configurations.add(ve);const _e={type:"component",name:"UI_FORM_MYRECORDS_BUTTON_LEADBOARD",sprites:[{name:"ui_elements",url:"/ui/ui.json"}],audio:[{name:"sound_button_press",url:"/ui/joystick-trigger-button.mp3"}],startComposition:"active",scale:{x:1,y:1},position:{x:0,y:0},compositions:{active:{button:"active"},hover:{button:"hover"},press:{button:"press"}},layers:[{layerType:"sprite",layerName:"button",spriteName:"ui_elements",frameName:"leadboard_button_active"}],presets:[{name:"active",params:[{time:1,name:"animate_reset",frameName:"leadboard_button_active",loop:1}]},{name:"hover",params:[{time:1,name:"animate_reset",frameName:"leadboard_button_hover",loop:1}]},{name:"press",params:[{time:1,name:"animate_reset",frameName:"leadboard_button_press",loop:1}]}],animators:[{name:"animate_reset",handler:function(e,t,i,n){i.sprite?t.setTexture(i.sprite,i.frame):i.frame&&t.setFrame(i.frame),i.frameName&&t.setFrame(i.frameName),"number"==typeof i.dy&&t.setPosition(null,i.dy),i.blendmode&&t.setBlendMode(i.blendmode),"number"==typeof i.scale?t.setScale(i.scale):"object"==typeof i.scale&&t.setScale(i.scale.x,i.scale.y),"number"==typeof i.alpha&&t.setAlpha(i.alpha),"number"==typeof i.angle&&t.setAngle(i.angle)}}],on:[{name:"down",listener:function(){this.play("press",!0),PIXI.sound.play("sound_button_press")}},{name:"up",listener:function(){this.play("hover",!0),this.game.emit("ui.close"),this.game.emit("ui.open.leadboard")}},{name:"over",listener:function(){this.play("hover",!0)}},{name:"out",listener:function(){this.play("active",!0)}}],events:[]};configurations.add(_e);const xe={type:"component",name:"UI_FORM_MYRECORDS_BUTTON_MI",sprites:[{name:"ui_elements",url:"/ui/ui.json"}],audio:[{name:"sound_button_press",url:"/ui/joystick-trigger-button.mp3"}],startComposition:"active",scale:{x:1,y:1},position:{x:0,y:0},compositions:{active:{button:"active"},hover:{button:"hover"},press:{button:"press"}},layers:[{layerType:"sprite",layerName:"button",spriteName:"ui_elements",frameName:"login_button_active"}],presets:[{name:"active",params:[{time:1,name:"animate_reset",frameName:"login_button_active",loop:1}]},{name:"hover",params:[{time:1,name:"animate_reset",frameName:"login_button_hover",loop:1}]},{name:"press",params:[{time:1,name:"animate_reset",frameName:"login_button_press",loop:1}]}],animators:[{name:"animate_reset",handler:function(e,t,i,n){i.sprite?t.setTexture(i.sprite,i.frame):i.frame&&t.setFrame(i.frame),i.frameName&&t.setFrame(i.frameName),"number"==typeof i.dy&&t.setPosition(null,i.dy),i.blendmode&&t.setBlendMode(i.blendmode),"number"==typeof i.scale?t.setScale(i.scale):"object"==typeof i.scale&&t.setScale(i.scale.x,i.scale.y),"number"==typeof i.alpha&&t.setAlpha(i.alpha),"number"==typeof i.angle&&t.setAngle(i.angle)}}],on:[{name:"down",listener:function(){this.play("press",!0),PIXI.sound.play("sound_button_press")}},{name:"up",listener:function(){this.play("hover",!0)}},{name:"over",listener:function(){this.play("hover",!0)}},{name:"out",listener:function(){this.play("active",!0)}}],events:[]};configurations.add(xe);const ke={type:"component",name:"UI_FORM_MYRECORDS_BUTTON_PLAY",sprites:[{name:"ui_elements",url:"/ui/ui.json"}],audio:[{name:"sound_button_press",url:"/ui/joystick-trigger-button.mp3"}],startComposition:"active",scale:{x:1,y:1},position:{x:0,y:0},compositions:{active:{button:"active"},hover:{button:"hover"},press:{button:"press"}},layers:[{layerType:"sprite",layerName:"button",spriteName:"ui_elements",frameName:"play_button_active"}],presets:[{name:"active",params:[{time:1,name:"animate_reset",frameName:"play_button_active",loop:1}]},{name:"hover",params:[{time:1,name:"animate_reset",frameName:"play_button_hover",loop:1}]},{name:"press",params:[{time:1,name:"animate_reset",frameName:"play_button_press",loop:1}]}],animators:[{name:"animate_reset",handler:function(e,t,i,n){i.sprite?t.setTexture(i.sprite,i.frame):i.frame&&t.setFrame(i.frame),i.frameName&&t.setFrame(i.frameName),"number"==typeof i.dy&&t.setPosition(null,i.dy),i.blendmode&&t.setBlendMode(i.blendmode),"number"==typeof i.scale?t.setScale(i.scale):"object"==typeof i.scale&&t.setScale(i.scale.x,i.scale.y),"number"==typeof i.alpha&&t.setAlpha(i.alpha),"number"==typeof i.angle&&t.setAngle(i.angle)}}],on:[{name:"down",listener:function(){this.play("press",!0),PIXI.sound.play("sound_button_press")}},{name:"up",listener:function(){this.play("hover",!0),this.game.emit("ui.close"),this.game.world.reset()}},{name:"over",listener:function(){this.play("hover",!0)}},{name:"out",listener:function(){this.play("active",!0)}}],events:[{name:"ui.open.myrecords",listener:function(){this.game.keyboard.setListeners({SPACE:()=>{this.play("press",!0),PIXI.sound.play("sound_button_press"),setTimeout((()=>{this.play("active",!0),this.game.emit("ui.close"),this.game.world.reset()}),200)}},this)}}]};configurations.add(ke);const we={fontFamily:"Zubilo Black",fontSize:80,fill:64791,align:"center",fontWeight:200,dropShadow:!0,dropShadowAngle:Math.PI/2,dropShadowBlur:1,dropShadowDistance:6,dropShadowAlpha:.5},Ne={type:"component",name:"UI_FORM_MYRECORDS",sprites:[{name:"ui_sign",url:"/ui/info_plate_big.png"},{name:"ui_elements",url:"/ui/ui.json"}],components:["/ui_form_myrecords_button_mi.js","/ui_form_myrecords_button_leadboard.js","/ui_form_myrecords_button_play.js"],audio:[],scale:{x:.66,y:.66},position:{x:0,y:0},compositions:{base:{background:"base",sprite:"base",text:"base",button:"base",score:"base",username:"base"}},layers:[{layerType:"sprite",layerName:"background",spriteName:"ui_sign",frameName:0,origin:.5},{layerType:"sprite",layerName:"sprite",spriteName:"ui_elements",frameName:"header_info_plate",origin:.5,position:{x:0,y:-408}},{layerType:"text",layerName:"text",origin:{x:.5,y:0},scale:1,position:{x:0,y:-465},text:"Твои рекорды\n",style:{fontFamily:"Zubilo Black",fontSize:65,fill:15729,align:"center",fontWeight:200}},{layerType:"text",layerName:"text",origin:{x:.5,y:0},scale:1,position:{x:0,y:-370},text:"Рекорд:\n",style:we},{layerType:"text",layerName:"score",origin:{x:.5,y:0},scale:1,position:{x:0,y:-270},text:"0\n",style:we},{layerType:"sprite",layerName:"sprite",spriteName:"ui_elements",frameName:"user_name_bar",origin:.5,position:{x:0,y:120}},{layerType:"text",layerName:"username",origin:{x:0,y:0},scale:1,position:{x:-270,y:85},text:"Qwerty12\n",style:{fontFamily:"Zubilo Black",fontSize:60,fill:16777215,align:"left",fontWeight:200}},{layerType:"component",layerName:"button",componentName:"UI_FORM_MYRECORDS_BUTTON_MI",scale:1.5,position:{x:0,y:-65}},{layerType:"component",layerName:"button",componentName:"UI_FORM_MYRECORDS_BUTTON_LEADBOARD",scale:1.5,position:{x:-167,y:310}},{layerType:"component",layerName:"button",componentName:"UI_FORM_MYRECORDS_BUTTON_PLAY",scale:1.5,position:{x:167,y:310}}],presets:[{name:"base",params:[]},{name:"rotate1",params:[{time:15e3,name:"animate_rotate",loop:0},{time:3e3,name:"animate_scale",loop:0,yoyo:!0,from:.95,to:1.2}]},{name:"rotate2",params:[{time:2e4,name:"animate_rotate",loop:0,reverse:!1},{time:1e3,name:"animate_scale",loop:0,yoyo:!0,from:.8,to:1}]},{name:"noise",params:[{time:4500,name:"star_rotate",loop:0,yoyo:!1,from:-10,to:10},{time:3100,name:"animate_scale",loop:0,yoyo:!0,from:.95,to:1.05}]}],animators:[{name:"animate_reset",handler:function(e,t,i,n){i.sprite?t.setTexture(i.sprite,i.frame):i.frame&&t.setFrame(i.frame),i.frameName&&t.setFrame(i.frameName),"number"==typeof i.scale?t.setScale(i.scale):"object"==typeof i.scale&&t.setScale(i.scale.x,i.scale.y),"number"==typeof i.alpha&&t.setAlpha(i.alpha),"number"==typeof i.angle&&t.setAngle(i.angle)}},{name:"animate_frames",handler:function(e,t,i,n){const s="number"==typeof i.from?i.from:0,r=("number"==typeof i.to?i.to:i.frames.length)-s,a=s+Math.floor(e*r),o=i.frames[a];i.sprite?t.setTexture(i.sprite,o):t.setFrame(o)}},{name:"animate_scale",handler:function(e,t,i,n){const s="number"==typeof i.from?i.from:0,r=s+e*(("number"==typeof i.to?i.to:1)-s);t.setScale(r)}},{name:"animate_alpha",handler:function(e,t,i,n){const s="number"==typeof i.from?i.from:0,r=s+e*(("number"==typeof i.to?i.to:1)-s);t.setAlpha(r)}},{name:"animate_rotate",handler:function(e,t,i,n){const s="number"==typeof i.from?i.from:0,r=s+e*(("number"==typeof i.to?i.to:360)-s);t.setAngle(r)}},{name:"star_rotate",handler:function(e,t,i,n){const s=t.config.middle||.5;e=e<s?.5*e/s:.5+.5*(e-s)/(1-s),e=2*Math.abs(e-.5),t.config.reverse&&(e=1-e);const r="number"==typeof i.from?i.from:0,a=r+e*(("number"==typeof i.to?i.to:360)-r);t.setAngle(a)}}],events:[{name:"ui.close",listener:function(){this.isOpen=!1,this.hide()}},{name:"ui.open.myrecords",listener:function(){this.isOpen=!0,this.layersMap.score.setText(this.game.userdata.score),this.layersMap.username.setText(this.game.userdata.name),this.play("base",!0)}}]};configurations.add(Ne);const Te={type:"component",name:"UI_FORM_YOURSCORE_BUTTON_OK",sprites:[{name:"ui_elements",url:"/ui/ui.json"}],audio:[{name:"sound_button_press",url:"/ui/joystick-trigger-button.mp3"}],startComposition:"active",scale:{x:1,y:1},position:{x:0,y:0},compositions:{active:{button:"active"},hover:{button:"hover"},press:{button:"press"}},layers:[{layerType:"sprite",layerName:"button",spriteName:"ui_elements",frameName:"ok_button_active"}],presets:[{name:"active",params:[{time:1,name:"animate_reset",frameName:"ok_button_active",loop:1}]},{name:"hover",params:[{time:1,name:"animate_reset",frameName:"ok_button_hover",loop:1}]},{name:"press",params:[{time:1,name:"animate_reset",frameName:"ok_button_press",loop:1}]}],animators:[{name:"animate_reset",handler:function(e,t,i,n){i.sprite?t.setTexture(i.sprite,i.frame):i.frame&&t.setFrame(i.frame),i.frameName&&t.setFrame(i.frameName),"number"==typeof i.dy&&t.setPosition(null,i.dy),i.blendmode&&t.setBlendMode(i.blendmode),"number"==typeof i.scale?t.setScale(i.scale):"object"==typeof i.scale&&t.setScale(i.scale.x,i.scale.y),"number"==typeof i.alpha&&t.setAlpha(i.alpha),"number"==typeof i.angle&&t.setAngle(i.angle)}}],on:[{name:"down",listener:function(){this.play("press",!0),PIXI.sound.play("sound_button_press")}},{name:"up",listener:function(){this.play("hover",!0),this.game.emit("ui.close"),this.game.emit("ui.open.leadboard")}},{name:"over",listener:function(){this.play("hover",!0)}},{name:"out",listener:function(){this.play("active",!0)}}],events:[{name:"ui.open.youscore",listener:function(){this.game.keyboard.setListeners({SPACE:()=>{this.play("press",!0),PIXI.sound.play("sound_button_press"),setTimeout((()=>{this.play("active",!0),this.game.emit("ui.close"),this.game.emit("ui.open.leadboard")}),200)}},this)}}]};configurations.add(Te);const Se={fontFamily:"Zubilo Black",fontSize:65,fill:15729,align:"center",fontWeight:200},Oe={...Se,fontSize:200,fill:52224,dropShadow:!0,dropShadowAngle:Math.PI/2,dropShadowBlur:1,dropShadowDistance:6,dropShadowAlpha:.5},Ae={...Oe,fontSize:110,fill:16035109},Pe={type:"component",name:"UI_FORM_YOUSCORE",sprites:[{name:"ui_sign",url:"/ui/info_plate_big.png"},{name:"ui_rays",url:"/ui/rays.png"},{name:"ui_elements",url:"/ui/ui.json"}],components:["/ui_form_youscore_button_ok.js"],audio:[],scale:{x:.66,y:.66},position:{x:0,y:-1e3},compositions:{youscore:{background:"base",sprite:"base",text_youscore:"base",text:"base",score:"base",money:"base",distance:"base",button:"base",GROUP:"shift"},newrecord:{rays1:"rotate1",star:"noise",background:"base",sprite:"base",text_newrecord:"base",text:"base",score:"base",money:"base",distance:"base",button:"base",GROUP:"shift"}},layers:[{layerType:"sprite",layerName:"rays1",spriteName:"ui_rays",frameName:0,origin:.5,alpha:.5,blend:"ADD_NPM"},{layerType:"sprite",layerName:"rays2",spriteName:"ui_rays",frameName:0,origin:.5,alpha:.5},{layerType:"sprite",layerName:"background",spriteName:"ui_sign",frameName:0,origin:.5},{layerType:"sprite",layerName:"sprite",spriteName:"ui_elements",frameName:"header_info_plate",origin:.5,position:{x:0,y:-408}},{layerType:"text",layerName:"text_newrecord",origin:{x:.5,y:0},scale:1,position:{x:0,y:-465},text:"Новый рекорд:\n",style:Se},{layerType:"text",layerName:"text_youscore",origin:{x:.5,y:0},scale:1,position:{x:0,y:-465},text:"Твои очки:\n",style:Se},{layerType:"text",layerName:"score",origin:{x:.5,y:0},scale:1,position:{x:0,y:-370},text:"0\n",style:Oe},{layerType:"sprite",layerName:"sprite",spriteName:"ui_elements",frameName:"collect_coin_icon",origin:.5,position:{x:-240,y:-50}},{layerType:"text",layerName:"money",origin:{x:.5,y:0},scale:1,position:{x:0,y:-120},text:"0\n",style:Ae},{layerType:"sprite",layerName:"sprite",spriteName:"ui_elements",frameName:"collect_distance_icon",origin:.5,position:{x:-240,y:130}},{layerType:"text",layerName:"distance",origin:{x:.5,y:0},scale:1,position:{x:0,y:60},text:"0 м\n",style:{...Ae,fill:10143487}},{layerType:"component",layerName:"button",componentName:"UI_FORM_YOURSCORE_BUTTON_OK",scale:1.5,position:{x:0,y:365}},{layerType:"sprite",layerName:"star",spriteName:"ui_elements",frameName:"star",origin:.5,scale:1,position:{x:-506,y:-347},reverse:!0,middle:.4},{layerType:"sprite",layerName:"star",spriteName:"ui_elements",frameName:"star",origin:.5,scale:.7,position:{x:-546,y:-116},middle:.7},{layerType:"sprite",layerName:"star",spriteName:"ui_elements",frameName:"star",origin:.5,scale:1.35,position:{x:-584,y:116},reverse:!0,middle:.5},{layerType:"sprite",layerName:"star",spriteName:"ui_elements",frameName:"star",origin:.5,scale:1,position:{x:-492,y:347},middle:.3},{layerType:"sprite",layerName:"star",spriteName:"ui_elements",frameName:"star",origin:.5,scale:1,position:{x:506,y:-347},middle:.3},{layerType:"sprite",layerName:"star",spriteName:"ui_elements",frameName:"star",origin:.5,scale:1.35,position:{x:546,y:-116},reverse:!0,middle:.6},{layerType:"sprite",layerName:"star",spriteName:"ui_elements",frameName:"star",origin:.5,scale:.7,position:{x:584,y:116},middle:.4},{layerType:"sprite",layerName:"star",spriteName:"ui_elements",frameName:"star",origin:.5,scale:1,position:{x:492,y:347},reverse:!0,middle:.7}],presets:[{name:"base",params:[]},{name:"rotate1",params:[{time:15e3,name:"animate_rotate",loop:0},{time:3e3,name:"animate_scale",loop:0,yoyo:!0,from:.95,to:1.2}]},{name:"rotate2",params:[{time:2e4,name:"animate_rotate",loop:0,reverse:!1},{time:1e3,name:"animate_scale",loop:0,yoyo:!0,from:.8,to:1}]},{name:"noise",params:[{time:4500,name:"star_rotate",loop:0,yoyo:!1,from:-10,to:10},{time:3100,name:"animate_scale",loop:0,yoyo:!0,from:.95,to:1.05}]},{name:"shift",params:[{time:500,name:"animate_shift",loop:1,from:-window.innerHeight/2,to:window.innerHeight/2}]}],animators:[{name:"animate_reset",handler:function(e,t,i,n){i.sprite?t.setTexture(i.sprite,i.frame):i.frame&&t.setFrame(i.frame),i.frameName&&t.setFrame(i.frameName),"number"==typeof i.scale?t.setScale(i.scale):"object"==typeof i.scale&&t.setScale(i.scale.x,i.scale.y),"number"==typeof i.alpha&&t.setAlpha(i.alpha),"number"==typeof i.angle&&t.setAngle(i.angle)}},{name:"animate_frames",handler:function(e,t,i,n){const s="number"==typeof i.from?i.from:0,r=("number"==typeof i.to?i.to:i.frames.length)-s,a=s+Math.floor(e*r),o=i.frames[a];i.sprite?t.setTexture(i.sprite,o):t.setFrame(o)}},{name:"animate_scale",handler:function(e,t,i,n){const s="number"==typeof i.from?i.from:0,r=s+e*(("number"==typeof i.to?i.to:1)-s);t.setScale(r)}},{name:"animate_alpha",handler:function(e,t,i,n){const s="number"==typeof i.from?i.from:0,r=s+e*(("number"==typeof i.to?i.to:1)-s);t.setAlpha(r)}},{name:"animate_rotate",handler:function(e,t,i,n){const s="number"==typeof i.from?i.from:0,r=s+e*(("number"==typeof i.to?i.to:360)-s);t.setAngle(r)}},{name:"star_rotate",handler:function(e,t,i,n){const s=t.config.middle||.5;e=e<s?.5*e/s:.5+.5*(e-s)/(1-s),e=2*Math.abs(e-.5),t.config.reverse&&(e=1-e);const r="number"==typeof i.from?i.from:0,a=r+e*(("number"==typeof i.to?i.to:360)-r);t.setAngle(a)}},{name:"animate_shift",handler:function(e,t,i,n){const s="number"==typeof i.from?i.from:-window.innerHeight/2,r=("number"==typeof i.to?i.to:window.innerHeight/2)-s;t.group.y=s+e*r}}],events:[{name:"ui.close",listener:function(){this.isOpen=!1,this.group.y=-1e3,this.hide()}},{name:"ui.open.youscore",listener:function(e){this.isOpen=!0,this.layersMap.score.setText(e.score+"\n"),this.layersMap.money.setText(e.money+"\n"),this.layersMap.distance.setText(e.distance+" м\n"),e.score>this.game.userdata.score?(this.play("newrecord",!0),this.game.userdata={...this.game.userdata,...e},this.game.fakeAjax("https://lastuniverse.ru/pixi.js/api/user","POST",e,(e=>{}))):this.play("youscore",!0)}}]};function je(e){return(je="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Me(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Ee(e,t){return(Ee=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ce(e,t){return!t||"object"!==je(t)&&"function"!=typeof t?Ie(e):t}function Ie(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Re(e){return(Re=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}configurations.add(Pe),document.body.innerHTML="",new(function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ee(e,t)}(a,e);var t,i,n,s,r=(n=a,s=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Re(n);if(s){var i=Re(this).constructor;e=Reflect.construct(t,arguments,i)}else e=t.apply(this,arguments);return Ce(this,e)});function a(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(e=r.call(this,!1)).fakeAjax=oe,e.app=new PIXI.Application({width:256,height:256,backgroundColor:398905}),document.body.appendChild(e.app.view),e.app.renderer.view.style.position="absolute",e.app.renderer.view.style.display="block",e.app.renderer.resize(window.innerWidth,window.innerHeight),e.keyboard=new ee(Ie(e)),e.factory=new U(Ie(e),"./resources/"),e.objects={},e.emit("game.init",Ie(e)),e.world=new Q(Ie(e)),e.preload(),e}return t=a,(i=[{key:"preload",value:function(){var e=this;console.log("[game.preload]"),this.emit("game.preload",this),this.app.loader.load((function(){e.fakeAjax("https://lastuniverse.ru/pixi.js/api/user","GET",{},(function(t){e.userdata=t,e.create()}))}))}},{key:"create",value:function(){var e=this;console.log("[game.create]"),this.emit("game.create",this),this.objects.uiFormMyrecords=this.factory.getComponent("UI_FORM_MYRECORDS").setScale(1).setPosition(this.app.screen.width/2,this.app.screen.height/2).addToGroup(this.app.stage),this.objects.uiFormLeadboard=this.factory.getComponent("UI_FORM_LEADBOARD").setScale(1).setPosition(this.app.screen.width/2,this.app.screen.height/2).addToGroup(this.app.stage),this.objects.uiFormYouscore=this.factory.getComponent("UI_FORM_YOUSCORE").setScale(1).setPosition(this.app.screen.width/2,this.app.screen.height/2).addToGroup(this.app.stage),this.emit("ui.open.myrecords"),this.app.ticker.maxFPS=60,this.app.ticker.minFPS=60,this.app.ticker.add((function(t){e.update(e.app.ticker.elapsedMS,t)}))}},{key:"update",value:function(e,t){this.emit("game.update",e,t)}},{key:"_getTillingSprite",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0,s=this._getTexture(e,t);return new PIXI.TilingSprite(s,i,n)}},{key:"_getSprite",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=this._getTexture(e,t);return new PIXI.Sprite(i)}},{key:"_getTexture",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(!e||"string"!=typeof e)throw"Sprite ".concat(e," must be nonzero string");var i=this.app.loader.resources[e];if(!i)throw"Sprite ".concat(e," must be loaded before used");if(i.textures){if(["string","number"].indexOf(je(t))<0)throw"Frame ".concat(t," of sprite ").concat(e," must be number or nonzero string");var n=Object.values(i.textures),s=i.textures[t]||n[t]||n[0];return s}if(i.texture)return i.texture;throw"ups!!!"}}])&&Me(t.prototype,i),a}(s))}();